<div class="col-md-6" ng-init="tabname = 'campanha'">
  <h4>Informações da campanha</h4>
  <p>Os campos marcados com o asterisco (*) são de preenchimento obrigatório.</p>
  <br class="divider">

  <% content_tag :form, name: 'campaignForm', class: 'angular-form', 'ng-submit' => "save_campaign(campaignForm.$valid)", novalidate: '' do %>
    <div class="row">
      <div class="form-group icon-left icon-with-label col-md-12">
        <label for="raising_goal">Quanto quer arrecadar?</label>*
        <i class="fa fa-money"></i>    
        <input class="form-control" type="text" name="raising_goal" ng-model="candidate.raising_goal" ui-number-mask="2" required>
        <p class="help-block" ng-show="error_list.length > 0">
          <small>A quantia a ser arrecadada deve ser definida.</small>
        </p>
      </div>
      <div class="form-group icon-left icon-with-label col-md-12">
        <label for="party_fund">Valor recebido através do Fundo Partidário</label>*
        <i class="fa fa-money"></i>    
        <input class="form-control" type="text" name="party_fund" ng-model="candidate.party_fund" ui-number-mask="2">
      </div>
    </div>
    <div class="row">
      <div class="form-group icon-left icon-with-label col-md-12">
        Quais são seus assuntos prioritarios? * Máximo 4 opções
      </div>
      <div class="priority-subjects--list">
        <div class="text-danger" ng-if="issue_list.lenght">
          Não foi possível carregar a lista de assuntos.
        </div>
        <div class="col-md-6" style="font-size:12px;" ng-repeat="i in issue_list | orderBy: '+name'">
          <div class="checkbox">
            <label>
              <input type="checkbox" ng-model="i.selected" ng-change="count_checked(this)" value="{{i.id}">&nbsp; {{i.name}}
            </label>
          </div>
        </div>
      </div>
      <div class="form-group icon-left icon-with-label col-md-12">
        <small class="help-block">Caso não encontre um assunto de sua preferência, por favor entre em contato conosco através do e-mail: <a href="mailto:contato@votolegal.org.br">contato@votolegal.org.br</a>.</small>
      </div>
      <div class="form-group col-md-12 text-right hide">
        <a data-toggle="modal" data-target="#new-issue-priority" href="javascript:void(0);">+ Adicionar um assunto</a>
      </div>

      <div class="form-group col-md-12">
        <br class="divider">
      </div>
      

      <div class="form-group col-md-12">
        <label>Planilhar simplificada de gastos da campanha</label>
        <span class="help-block">Envie sua <em class="text-warning">planilha simplificada</em> de orçamento de campanha que justifique sua meta para arrecadação.</span>
      </div>

      <div class="form-group col-md-12">
        <div class="input-group image-preview">
        <input type="text" class="form-control image-preview-filename spending_spreadsheet_filename" value="{{candidate.spending_spreadsheet}}" disabled="disabled"> 
          <span class="input-group-btn">
            <!-- image-preview-input -->
            <div class="btn btn-default image-preview-input">
              <span class="fa fa-folder"></span>
              <span class="image-preview-input-title">Escolher Arquivo</span>
              <input type="file" name="spending_spreadsheet" ng-model="candidate.spending_spreadsheet" onchange="angular.element(this).scope().change_filename('spending_spreadsheet')" /> <!-- rename it -->
            </div>
          </span>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="form-group col-md-12">
        <h3 class="text-success">Terminal de captura</h3>
        <small>Dados da conta da operadora financeira para recebimento de doações</small>
      </div>
      <div class="form-group col-md-12">
        <label>Token operadora financeira</label>
        <span class="help-block">Após sua candidatura ser aprovada pelo <em class="text-warning" title="Trinunal Superior Eleitoral">TSE</em> você deverá assinar um contrato com alguma <em class="text-warning">operadora financeira</em> para poder receber doações na sua conta de campanha. Insira aqui o Token enviado pela da operadora.</span>
      </div>
      <div class="form-group icon-left icon-with-label col-md-12">
        <label for="">Provedora de pagamento</label>
        <select class="form-control">
          <option selected>PagSeguro</option>
        </select>
        <input type="hidden" id="payment_gateway_id" name="payment_gateway_id" ng-model="candidate.payment_gateway_id" value="2">
      </div>
      <div class="form-group icon-left icon-with-label col-md-12">
        <label for="merchant_id">E-mail de Cadastro do PagSeguro</label>
        <i class="fa fa-lock"></i>    
        <input class="form-control" type="text" name="merchant_id" ng-model="candidate.merchant_id" placeholder="E-mail de pagamento" required>
        <small class="help-block">Você deve colocar o mesmo e-mail utilizado para se cadastrar no PagSeguro.</small>
      </div>
      <div class="form-group icon-left icon-with-label col-md-12">
        <label for="merchant_key">Token</label>
        <i class="fa fa-lock"></i>    
        <input class="form-control" type="text" name="merchant_key" ng-model="candidate.merchant_key" placeholder="Token de pagamento" required>
      </div>

      <!-- recibos -->
      <div class="form-group col-md-12">
        <h3 class="text-success">Numeração dos recibos</h3>
        <small>Essa numeração é utilizada para a prestação de contas</small>
      </div>
      <div class="form-group _icon-left icon-with-label col-md-6">
        <label for="receipt_min">Número mínimo</label>
        <input class="form-control" type="text" name="receipt_min" ng-model="candidate.receipt_min" mask="d" mask-repeat="10" mask-restrict="reject" mask-validate="false" mask-clean="true" required>
      </div>
      <div class="form-group icon-left col-md-6">
        <label for="receipt_max">Número máximo</label>
        <input class="form-control" type="text" name="receipt_max" ng-model="candidate.receipt_max" mask="d" mask-repeat="10" mask-restrict="reject" mask-validate="false" mask-clean="true" required>
      </div>
    </div>

    <div class="row">
      <div class="form-group col-md-12" ng-init="submit_disabled = false">
        <p class="text-right">
          <button type="submit" id="btn-enviar" ng-disabled="submit_disabled" class="btn btn-success btn-lg">Gravar</button>
        </p>
        <div ng-show="error_list.length > 0" style="margin: 30px 0px; border: 2px solid rgb(234, 53, 53); color: rgb(234, 53, 53); padding: 10px 15px; border-radius: 5px;" class="error-panel">
          <h4>Os seguinte campos precisam ser corrigidos:</h4>
          <ul ng-repeat="error in error_list" style="margin: 0px; list-style-type: square; padding: 0px 0px 0px 40px;" class="ng-scope" ng-repeat="error in error_list">
            <li>{{error}}</li>
          </ul>
        </div>
      </div>
    </div>
  <% end %>

<div id="new-issue-priority" class="modal fade" tabindex="-1" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">Novo assunto prioritário</h4>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <input type="text" class="form-control" names="issue_name" ng-model="issue_name">
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
        <button type="button" class="btn btn-success" ng-click="create_issue()">Cadastrar</button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

</div>
