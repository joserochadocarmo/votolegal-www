app.votolegal.controller("DonationHistoryController",["$scope","$http","$sce","serialize","auth_service","SweetAlert","trouble","postmon",function(o,e,a,t,d,s,r){document.querySelector("#loading");o.user=d.current_user(),o.error_list=[],o.donations=[],o.download={},o.history_list=function(a){var t=document.querySelector("#donations-table"),d=document.querySelector("#loading-donations"),i=document.querySelector("#donations-error");i&&i.classList.add("hide"),t&&(t.classList.add("hide"),d&&d.classList.remove("hide"));try{e({method:"GET",url:"/api/candidate/"+a.id+"/donate?api_key="+a.api_key}).then(function(e){var a=e.data.donations;o.donations=a;for(var s in o.donations){o.donations[s].captured_at=Date.parse(o.donations[s].captured_at);var r=o.donations[s].birthday.match(/^(\d{4})-(\d{2})-(\d{2})$/);o.donations[s].birthday=r[3]+"."+r[2]+"."+r[1]}t&&(d&&d.classList.add("hide"),t.classList.remove("hide"))},function(o){throw t&&(d&&d.classList.add("hide"),t.classList.remove("hide")),r.shoot({route:document.location.href,error:JSON.stringify(o)}),s.swal("Falha no carregamento dos dados","N\xe3o foi poss\xedvel carregar os dados de doa\xe7\xf5es."),new Error("Donation list is invalid or cannot be found!")})}catch(n){t&&(d&&d.classList.add("hide"),t.classList.remove("hide")),r.shoot({route:document.location.href,error:JSON.stringify(n)}),s.swal("Falha no carregamento dos dados","N\xe3o foi poss\xedvel carregar os dados de doa\xe7\xf5es.")}},o.download.csv_file=function(){var e=o.user;return console.log("/api/candidate/"+e.id+"/donate/download/csv?api_key="+e.api_key),"/api/candidate/"+e.id+"/donate/download/csv?api_key="+e.api_key},d.validate_user({role:"user"}),o.history_list(o.user)}]);