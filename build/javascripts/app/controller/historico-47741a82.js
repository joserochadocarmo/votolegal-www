app.votolegal.controller("DonationHistoryController",["$scope","$http","$sce","serialize","auth_service","SweetAlert","trouble","postmon",function(o,e,a,t,d,i,s){document.querySelector("#loading");o.user=d.current_user(),o.error_list=[],o.donations=[],o.download={},o.history_list=function(a){var t=document.querySelector("#donations-table"),d=document.querySelector("#loading-donations"),n=document.querySelector("#donations-error");n&&n.classList.add("hide"),t&&(t.classList.add("hide"),d&&d.classList.remove("hide"));try{e({method:"GET",url:"/api/candidate/"+a.id+"/donate?api_key="+a.api_key}).then(function(e){var a=e.data.donations;o.donations=a;for(var i in o.donations){o.donations[i].captured_at=Date.parse(o.donations[i].captured_at);var s=o.donations[i].birthday.match(/^(\d{4})-(\d{2})-(\d{2})$/);o.donations[i].birthday=s[3]+"."+s[2]+"."+s[1]}t&&(d&&d.classList.add("hide"),t.classList.remove("hide"))},function(o){throw t&&(d&&d.classList.add("hide"),t.classList.remove("hide")),s.shoot({route:document.location.href,error:JSON.stringify(o)}),i.swal("Falha no carregamento dos dados","N\xe3o foi poss\xedvel carregar os dados de doa\xe7\xf5es."),new Error("Donation list is invalid or cannot be found!")})}catch(r){t&&(d&&d.classList.add("hide"),t.classList.remove("hide"))}},o.download.csv_file=function(){var e=o.user;return console.log("/api/candidate/"+e.id+"/donate/download/csv?api_key="+e.api_key),"/api/candidate/"+e.id+"/donate/download/csv?api_key="+e.api_key},d.validate_user({role:"user"}),o.history_list(o.user)}]);